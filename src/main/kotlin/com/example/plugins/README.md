# plugins 

## Administration.kt

원격으로 종료하는 플러그인인데 기본으로 제공하는 플러그인임

## CookieJWTProvider.kt (직접 만듦 ㅎㅎ)

> JWT 플러그인과 Session 플러그인을 참조해서 만듦

html tag에서 자동으로 `src`에 해당하는 원격 리소스를 불러올 때 쿠키틀 첨부해서 보내게 되는데

로그인한 회원을 식별하기 위해서 기존에 이미 JWT를 쿠키에 저장하고 사용하기 때문에

이를 이용해서 쿠키의 Session-ID 를 이용하는 Session 플러그인을 개조해서 만들었다.

쿠키내에 있는 JWT를 찾아서 디코딩이 가능하면 권한이 있는 것으로 파악하는 원리다.

* JWT 유효하다는 의미

1. JWT Secret 이 일치하면서 **동시에** 토큰 유효기간이 지나지 않은 토큰

2. 토큰 발행 패턴에 따라 `audience`, `issuer` 등 표준 키 값에 해당하는 값들이 일치하는 경우

단점으로는 로그아웃을 할 경우 토큰이 유효기간이 남아 있지만, 다시 재활용 될 수 있다는 약점이 존재한다.

로그아웃을 직접 사용자가 클릭할 경우 프론트에서 쿠키를 직접 지우는 방법이 존재하고

(사실 이 부분은 쿠키 관리, 즉 프론트의 재량도 일부 포함)

철저하게 관리하기 위해서 (쿠키를 로그아웃하기 전에 미리 빼돌릴 경우)

로그아웃된 JWT를 다른 캐시서버(Redis)에 저장해 백엔드가 확인하는 방법이 있다.

## Databases.kt

아직 구현 제대로 안함 

## HTTP.kt

HTTP 통신 규칙에 대해서 (대표적으로 CORS) 관리하는 정책

리버스 프록시를 사용하는 경우 IP 주소를 포워딩하는 `Header` 관리 플러그인 등이 있다.

## Monitoring.kt

API 호출 모니터링 (말 그대로 ㅇㅇ)

## Routing.kt

라우팅 경로

## Security.kt

인증 검증 과정을 어떻게 할지 정의하는 로직이다.

여기에 `CookieJWTProvider` 플러그인이 사용된다

이 코드를 사용하고 싶으면 아래 코드 부분을 주석처리하고

```kt
cookieJWT {
    //...
}
```

jwt 이 부분을 주석을 다시 없앤 다음에

```kt
jwt {
    // ...
}
```

`Header`에

```json
{
  "Authentication" : "Berear <JWT token>"
}
```

이런식으로 보내서 확인할 수 있다.

## Serialization.kt

데이터 직렬화(예 : JSON)를 위해 사용되는 플러그인

안에 작성된 `routing()`은 그냥 예시 코드이므로 지워도 상관없다.